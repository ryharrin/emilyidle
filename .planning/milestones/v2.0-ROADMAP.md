# Milestone v2.0: Upcoming Major Changes to Game Design

**Status:** âœ… SHIPPED 2026-01-25
**Phases:** 13-18
**Total Plans:** 23

## Overview

Major gameplay and structure milestone: shift Collection to an enjoyment-first economy, add therapist career cash generation and dual-currency watch acquisition, introduce nostalgia prestige + permanent unlocks, and refactor the codebase into a clearer domain/runtime/UI module layout.

## Phases

### Phase 13: Enjoyment Economy Foundation

**Goal**: Shift core currency to enjoyment with watch tier modifiers.
**Depends on**: Phase 12
**Plans**: 2 plans

Plans:

- [x] 13-01: Enjoyment tiers + per-watch enjoyment rate calculation
- [x] 13-02: Enjoyment-first UI copy + per-watch enjoyment display

**Details:**
Implemented tier-based per-watch enjoyment income (preserving prestige legacy multiplier), then updated Collection UI and stats labels to lead with enjoyment while keeping selectors stable.

### Phase 14: Therapist Career Economy

**Goal**: Add therapist career progression to generate money alongside enjoyment.
**Depends on**: Phase 13
**Plans**: 2 plans

Plans:

- [x] 14-01: Therapist career economy (salary + sessions, persistence, sim integration)
- [x] 14-02: Career tab UI + milestone-gated visibility + stable test anchors

**Details:**
Added a hybrid cash faucet (passive salary plus cooldown-gated sessions spending enjoyment for cash + XP) and exposed it via a progress-gated Career tab.

### Phase 15: Dual-Currency Acquisition

**Goal**: Gate watch purchases by enjoyment while spending career-earned money.
**Depends on**: Phase 14
**Plans**: 3 plans

Plans:

- [x] 15-01: Dual-gate purchase logic (cash spent, enjoyment threshold)
- [x] 15-02: Vault UI: dollars price always, enjoyment lock messaging + icon
- [x] 15-03: Tests: unit + e2e coverage for dual-currency acquisition

**Details:**
Centralized gating via a shared purchase gate helper, wired it through buy/max-affordable logic, and added UI affordances + tests to lock the behavior.

### Phase 16: Nostalgia Prestige Reset

**Goal**: Redesign prestige to reset enjoyment/money and award nostalgia points.
**Depends on**: Phase 15
**Plans**: 3 plans

Plans:

- [x] 16-01: Core nostalgia prestige state + save-compatible reset logic
- [x] 16-02: Nostalgia tab UI with progress, confirmation modal, and results screen
- [x] 16-03: Tests: unit + e2e coverage for nostalgia prestige flow

**Details:**
Added a new prestige loop awarding nostalgia points on a diminishing returns curve, tracked per-run enjoyment earned, and shipped a guarded UI flow with unit + Playwright coverage.

### Phase 17: Nostalgia Unlocks

**Goal**: Use nostalgia points to permanently unlock watches across runs.
**Depends on**: Phase 16
**Plans**: 3 plans

Plans:

- [x] 17-01: Persist nostalgia unlocks + wire isItemUnlocked
- [x] 17-02: Nostalgia tab unlock store UI + confirmation toggle
- [x] 17-03: Tests: unit + e2e coverage for nostalgia unlocks

**Details:**
Introduced permanent unlock purchases (strict order + reverse refunds) and wired them into item gating so unlocked watches remain purchasable even when milestones are missing.

### Phase 18: Codebase Refactor

**Goal**: Refactor game files for clearer separation of logic, UI, and data models.
**Depends on**: Phase 17
**Plans**: 10 plans

Plans:

- [x] 18-01: Introduce game model layer + start state.ts facade
- [x] 18-02: Extract static game definition data into src/game/data/*
- [x] 18-03: Split state.ts into selectors/actions + facade re-exports
- [x] 18-04: Extract UI tab panels into src/ui/tabs/*
- [x] 18-05: Extract runtime orchestration into useGameRuntime hook
- [x] 18-06: Update internal AGENTS docs for new structure
- [x] 18-07: Full automated gates (lint/typecheck/unit/e2e/build)
- [x] 18-08: Manual smoke check
- [x] 18-09: Cleanup game-module refactor leftovers + lint
- [x] 18-10: Lint fix: unused imports in model state

**Details:**
Split the monolithic game module into model/data/selectors/actions/runtime layers, extracted tab UI into dedicated components, and verified refactor safety via automated gates plus a manual smoke pass.

---

## Milestone Summary

**Decimal Phases:**

- None.

**Key Decisions:**

- Use explicit per-watch enjoyment rates (stable UI display; tier-driven economy).
- Therapist earnings are hybrid (salary + sessions) and composed via a total cash/sec selector.
- Dual-currency acquisition gates watch purchases by enjoyment threshold while spending only cash.
- Nostalgia prestige threshold set to 12,000,000 enjoyment cents with sqrt gain for diminishing returns.
- Refactor strategy: keep `src/game/state.ts` as a stable facade while moving logic to model/data/selectors/actions and side effects to runtime.

**Issues Resolved:**

- No major blockers recorded during execution; regression coverage added throughout.

**Issues Deferred:**

- Missing `.planning/REQUIREMENTS.md` for v2.0 (requirement-level traceability not available).
- Missing phase verification reports for Phase 13 and Phase 18 (audit marked these as gaps).

**Technical Debt Incurred (Accepted at Ship):**

- No dedicated Playwright E2E asserting therapist session deltas (cash/enjoyment) and cooldown UX.
- Minor time-source brittleness noted by integration checker (session handler uses `Date.now()` directly).

---

_For current project status, see `.planning/ROADMAP.md`_
