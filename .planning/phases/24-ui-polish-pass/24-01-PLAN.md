---
phase: 24-ui-polish-pass
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/style.css
autonomous: true

must_haves:
  truths:
    - "Keyboard focus is clearly visible on nav tabs, buttons, links, and form controls"
    - "Primary buttons and progress fills provide subtle hover/pressed feedback"
    - "UI motion respects prefers-reduced-motion"
    - "Panels, headers, and stat grids stay readable on desktop and mobile widths"
  artifacts:
    - path: src/style.css
      provides: "Global UI primitives (focus rings, motion opt-out, layout helpers, micro-interactions)"
      contains: ":focus-visible"
    - path: src/style.css
      provides: "Stats grid helper used by StatsTab/App header"
      contains: ".stats-grid"
  key_links:
    - from: src/style.css
      to: "App tab nav"
      via: "aria-selected and focus-visible styling"
      pattern: "\\.page-nav-link\\[aria-selected=\"true\"\\]|\\.page-nav-link:focus-visible"
    - from: src/style.css
      to: "Progress indicators"
      via: "width transition"
      pattern: "nostalgia-progress-fill|teaser-fill"
---

<objective>
Harden global CSS primitives for focus, motion, layout, and micro-interactions so the whole UI becomes more consistent and readable without changing stable selectors.

Purpose: Deliver POLISH-03 and the global foundation for POLISH-01/02/04 with low-risk CSS-only improvements.
Output: Updated `src/style.css` with focus-visible rings, reduced-motion handling, stats grid helper, responsive header tweaks, and pressed/progress transitions.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/24-ui-polish-pass/24-RESEARCH.md
@src/style.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add global focus-visible rings (buttons, links, inputs)</name>
  <files>src/style.css</files>
  <action>
Add a visible, theme-aware keyboard focus ring using `:focus-visible`.

Implementation details:
- Define a focus ring color as CSS variables for both themes (default + `[data-theme="light"]`).
- Apply `outline` + `outline-offset` (do not remove outlines).
- Cover at minimum:
  - `button:focus-visible`
  - `.page-nav-link:focus-visible`
  - `.catalog-tab:focus-visible`
  - `.source-links a:focus-visible`
  - `.filter-field input:focus-visible` and `.filter-field select:focus-visible`
  - `.controls select:focus-visible`
  - `#import-save-text:focus-visible`
- Keep all selectors stable; do not change any `id` / `data-testid` attributes in TSX files.
  </action>
  <verify>pnpm run lint</verify>
  <done>Tabbing through nav/buttons/inputs shows a consistent focus ring in both dark and light themes.</done>
</task>

<task type="auto">
  <name>Task 2: Add reduced-motion support and pressed/active micro-interactions</name>
  <files>src/style.css</files>
  <action>
Add motion accessibility + tactile feedback:

- Add `@media (prefers-reduced-motion: reduce)` that disables non-essential animation/transition durations globally (using the common MDN pattern).
- Add pressed state for buttons:
  - `button:not(:disabled):active` uses a small translate/scale effect that reads as “pressed”.
  - Ensure hover vs active states do not fight (active should win).
- Add a clear selected state for top nav tabs using existing ARIA attributes:
  - `.page-nav-link[aria-selected="true"]` should be visually distinct from unselected (border/background/box-shadow), in both themes.
- Check base text vs muted text contrast in both themes; if muted text is too low-contrast, adjust the relevant CSS variables (keep changes minimal).
- Do not introduce new JS for focus/motion; keep it CSS-only.
  </action>
  <verify>pnpm run typecheck</verify>
  <done>Buttons show hover + pressed feedback, selected tab is obvious, and reduced-motion disables transitions when enabled.</done>
</task>

<task type="auto">
  <name>Task 3: Fill missing layout helpers and responsive primitives</name>
  <files>src/style.css</files>
  <action>
Improve scanability + mobile behavior with shared primitives:

- Add `.stats-grid` styles (used by `src/ui/tabs/StatsTab.tsx` and intended for reuse): grid layout, spacing, and dt/dd typography consistent with the existing `.stats` block.
- Add a small-screen breakpoint (suggested: `max-width: 640px`) to make `.panel-header` stack cleanly:
  - `flex-direction: column; align-items: flex-start;`
  - Ensure `.results-count` doesn’t overflow (use `white-space: nowrap;` and `max-width: 100%` as needed).
- Add progress fill transitions:
  - `.nostalgia-progress-fill` and `.teaser-fill` should animate width changes with a short ease, but be disabled under reduced motion.
  </action>
  <verify>pnpm run test:unit</verify>
  <done>`dl.stats-grid` is styled (no unstyled dense list), panel headers wrap neatly on mobile widths, and progress fills animate (unless reduced motion).</done>
</task>

</tasks>

<verification>
- `pnpm run lint`
- `pnpm run typecheck`
- `pnpm run test:unit`
</verification>

<success_criteria>
- Focus rings visible on keyboard navigation across the app (POLISH-03)
- Reduced motion preference disables transitions/animations (POLISH-04)
- Shared layout helpers exist (`.stats-grid`) and panel headers are mobile-safe (POLISH-01/02)
</success_criteria>

<output>
After completion, create `.planning/phases/24-ui-polish-pass/24-01-SUMMARY.md`
</output>
