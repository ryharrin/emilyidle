---
phase: 14-therapist-career-economy
type: execute
wave: 2
---

<objective>
Add Therapist Career UI for money generation.

Purpose: Make therapist progression legible and actionable in the UI (clear rates/costs/payouts), while keeping existing tab
visibility rules and test selectors stable.
Output: New Career tab + panel UI, updated stats display to reflect therapist cash, and unit coverage for tab visibility.
</objective>

<execution_context>
~/.config/opencode/get-shit-done/workflows/execute-phase.md
./summary.md
~/.config/opencode/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Phase 14 core logic (must be completed first)
@.planning/phases/14-therapist-career-economy/14-01-SUMMARY.md

# Relevant recent patterns
@.planning/phases/13-enjoyment-economy-foundation/13-02-SUMMARY.md

# UI + tests
@src/App.tsx
@src/game/state.ts
@tests/catalog.unit.test.tsx

**Tech stack available:** React, TypeScript, Vitest (Testing Library)
**Established patterns:** Tabs are conditionally visible via `tabVisibility` + settings; sections use stable `id` and `data-testid`
**Constraining decisions:** Keep existing `id`/`data-testid` stable; new selectors are additive
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Career tab + therapist panel UI</name>
  <files>src/App.tsx</files>
  <action>
    Add a new primary navigation tab + panel for the therapist career.

    Requirements:
    - Add a new entry to `TAB_DEFINITIONS`:
      - id: `career`
      - label: `Career`
    - Update tab visibility plumbing:
      - Add `career` into `tabVisibility` and `combinedTabVisibility`.
      - Keep behavior consistent with existing tests: a fresh save should still show only Vault and Save tabs.
        (Career tab should be hidden until some progress threshold is reached.)
    - Add the corresponding tabpanel section:
      - `<section id="career" role="tabpanel" aria-labelledby="career-tab" ...>`
      - Add stable `data-testid` anchors for tests: `career-panel`, `career-status`, `career-action`.

    UI content:
    - Display therapist level/progress and the current earning mechanic (session cost/payout/cooldown OR passive rate)
      based on the selectors added in 14-01.
    - Expose the primary action (if sessions/hybrid): button should be disabled when requirements not met
      (cooldown active or insufficient enjoyment).
    - If passive: show salary rate and the next upgrade/level requirement.

    Stats alignment:
    - Update the displayed cash/sec value to reflect the same cash earnings that `sim.step()` applies.
      If you introduced a `getTotalCashRateCentsPerSec` selector in 14-01, use it for the cash/sec display.
    - Keep existing `id` values stable (`currency`, `income`, etc). Prefer adding new rows instead of renaming.

    Do not:
    - Change existing tab ids or the existing section ids.
    - Change existing `id`/`data-testid` values that tests rely on.
  </action>
  <verify>
    Run `pnpm run test:unit -- tests/catalog.unit.test.tsx`.
  </verify>
  <done>
    Career tab and panel render when unlocked; fresh save behavior is unchanged; cash/sec display matches simulation.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update unit tests for tab visibility + career UI anchors</name>
  <files>tests/catalog.unit.test.tsx</files>
  <action>
    Extend existing unit coverage to protect the Career tab UX contract:

    - In the "fresh save" navigation test, assert Career tab is not visible.
    - Add a new describe block that seeds localStorage with a state that meets the Career reveal condition, then assert:
      - Career tab is present in the tablist
      - Career tabpanel renders when activated
      - `data-testid="career-panel"` is present

    Keep selectors stable: use roles (tab/tablist/tabpanel) and `data-testid` values.
  </action>
  <verify>
    Run `pnpm run test:unit -- tests/catalog.unit.test.tsx`.
  </verify>
  <done>
    Unit tests cover Career tab hidden-on-fresh-save and visible-when-unlocked behavior.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Career tab + therapist panel UI</what-built>
  <how-to-verify>
    1. Run: `pnpm dev`
    2. Fresh save: confirm only Vault + Save tabs are visible.
    3. Progress until Career unlock condition is met (per plan 14-01). Confirm Career tab appears.
    4. Open Career tab: confirm level/progress and action/rate are legible.
    5. Trigger the career action (if sessions): confirm cash changes and cooldown/disabled states behave.
    6. Confirm there are no console errors.
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `pnpm run test:unit -- tests/catalog.unit.test.tsx`
- [ ] `pnpm run typecheck`
</verification>

<success_criteria>

- Career tab exists, is gated by progress, and does not change fresh-save tab list
- Career UI exposes the therapist earning mechanic clearly and uses stable test selectors
- Unit tests cover tab visibility and basic Career UI anchors
  </success_criteria>

<output>
After completion, create `.planning/phases/14-therapist-career-economy/14-02-SUMMARY.md`:

# Phase 14 Plan 02 Summary

**[One-liner describing the therapist UI + gating]**

## Accomplishments

- [Key outcome 1]
- [Key outcome 2]

## Files Created/Modified

- `src/App.tsx` - [Description]
- `tests/catalog.unit.test.tsx` - [Description]

## Decisions Made

[Any gating/UI decisions, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Phase 14 complete, ready for next phase
</output>
