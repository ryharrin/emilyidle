---
phase: 20-help-iconography
plan: 04
type: execute
wave: 3
depends_on:
  - 20-02
  - 20-03
files_modified:
  - tests/help.spec.ts
autonomous: true

must_haves:
  truths:
    - "Help entry point is regression-protected by e2e coverage"
    - "Lock/prestige iconography changes are regression-protected by e2e assertions"
  artifacts:
    - path: "tests/help.spec.ts"
      provides: "Playwright coverage for help modal + icon cues"
  key_links:
    - from: "tests/help.spec.ts"
      to: "src/App.tsx"
      via: "data-testid=help-open"
      pattern: "help-open"
---

<objective>
Add Playwright coverage for the Help entry point and the standardized icon cues.

Purpose: Prevent regressions to GUIDE-01 and POLISH-05 as future UX work continues.
Output: A new e2e spec asserting help open/close/persistence and icon presence.
</objective>

<execution_context>
@~/.opencode/get-shit-done/workflows/execute-plan.md
@~/.opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@src/App.tsx
@tests/collection-loop.spec.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add help modal e2e test</name>
  <files>tests/help.spec.ts</files>
  <action>
Create `tests/help.spec.ts` with Playwright coverage that:

1. Opens the app at `/`.
2. Clicks the help icon button via `data-testid=help-open`.
3. Asserts `data-testid=help-modal` is visible.
4. Navigates to a non-default section via the modal UI.
5. Closes the modal via `data-testid=help-close`.
6. Reopens help and asserts the previously selected section is still active (persistence).

Also add a basic "available anywhere" smoke check:
- Click another tab (e.g. "Atelier") and confirm the help button still opens the modal.

Implementation notes:
- Prefer stable selectors: `getByTestId`, roles, and visible text.
- If you introduce a `data-testid` for the active section container (recommended), assert against it.
  </action>
  <verify>pnpm -s run test:e2e -- tests/help.spec.ts</verify>
  <done>The new help e2e spec passes and confirms open/close + last-section persistence.</done>
</task>

<task type="auto">
  <name>Task 2: Assert icon cues exist in key UI surfaces</name>
  <files>tests/help.spec.ts</files>
  <action>
Extend `tests/help.spec.ts` to assert standardized icons exist:

- Seed a state that triggers an enjoyment purchase gate (copy seeding pattern from `tests/collection-loop.spec.ts` "enjoyment gate locks classic purchase").
- Navigate to "Vault" and locate the purchase gate element (existing `data-testid` pattern: `purchase-gate-classic`).
- Assert the gate contains an `svg` element (lock icon).

- Navigate to "Atelier" and locate the primary reset CTA button (use existing `data-testid="workshop-panel"` scoping + button text).
- Assert that button contains an `svg` element (prestige icon).
  </action>
  <verify>pnpm -s run test:e2e -- tests/help.spec.ts</verify>
  <done>Help spec also asserts lock and prestige icons render where expected.</done>
</task>

</tasks>

<verification>
- `pnpm -s run test:e2e -- tests/help.spec.ts`
</verification>

<success_criteria>
- Help open/close and last-section persistence are covered by Playwright.
- At least one lock cue and one prestige cue are asserted to contain an SVG icon.
</success_criteria>

<output>
After completion, create `.planning/phases/20-help-iconography/20-04-SUMMARY.md`
</output>
