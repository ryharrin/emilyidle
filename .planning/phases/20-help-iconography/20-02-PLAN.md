---
phase: 20-help-iconography
plan: 02
type: execute
wave: 2
depends_on:
  - 20-01
files_modified:
  - src/App.tsx
  - src/style.css
  - src/ui/help/helpContent.ts
  - src/ui/help/HelpModal.tsx
autonomous: true

must_haves:
  truths:
    - "User can open Help from any tab"
    - "On mobile-sized viewports, Help opens as a full-screen modal that is easy to dismiss"
    - "Help remembers the last-open section when reopened"
  artifacts:
    - path: "src/ui/help/helpContent.ts"
      provides: "Canonical Help/Glossary sections"
    - path: "src/ui/help/HelpModal.tsx"
      provides: "Responsive modal UI for Help"
    - path: "src/App.tsx"
      provides: "Global Help open state + header entry point"
  key_links:
    - from: "src/App.tsx"
      to: "src/ui/help/HelpModal.tsx"
      via: "helpOpen state and props"
      pattern: "<HelpModal"
    - from: "src/ui/help/HelpModal.tsx"
      to: "window.localStorage"
      via: "persist lastSectionId"
      pattern: "emily-idle:help"
---

<objective>
Implement a global Help/Glossary entry point and modal that works on desktop and becomes full-screen on mobile, remembering the last-open section.

Purpose: Satisfy GUIDE-01 while keeping Help reachable and lightweight on mobile.
Output: Help content + Help modal + header help button wired from `src/App.tsx`.
</objective>

<execution_context>
@~/.opencode/get-shit-done/workflows/execute-plan.md
@~/.opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@.planning/phases/20-help-iconography/20-CONTEXT.md
@.planning/phases/20-help-iconography/20-RESEARCH.md

@src/App.tsx
@src/style.css
@src/ui/tabs/NostalgiaTab.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Help content module</name>
  <files>src/ui/help/helpContent.ts</files>
  <action>
Create `src/ui/help/helpContent.ts` exporting a small, stable set of Help sections for v2.1.

Requirements:
- Export a `HelpSection` type and a `HELP_SECTIONS` array.
- Use stable section ids (string literals) suitable for persistence.
- Keep content lightweight (short paragraphs / bullet lists as strings).

Suggested initial sections (minimum viable):
- Overview (what the game loop is)
- Currencies (enjoyment vs dollars vs Memories)
- Prestige (Atelier / Maison / Nostalgia)
- Locks (why things show locked and what to do next)
- Saving (autosave + export/import)
  </action>
  <verify>pnpm -s run typecheck</verify>
  <done>`HELP_SECTIONS` exists with stable `id` + `title` + `body` content for each section.</done>
</task>

<task type="auto">
  <name>Task 2: Build responsive HelpModal</name>
  <files>src/ui/help/HelpModal.tsx
src/style.css</files>
  <action>
Create `src/ui/help/HelpModal.tsx` using the existing overlay modal conventions (see Nostalgia modal), with responsive behavior:

Functional requirements:
- Props: `open`, `sections`, `activeSectionId`, `onSelectSectionId`, `onClose`.
- Adds `data-testid="help-modal"` on the overlay.
- Adds `data-testid="help-close"` on the close button.
- Supports keyboard escape to close.
- Locks background scroll while open and restores it on close.

Layout requirements:
- Desktop: centered modal card; internal scroll region for content.
- Mobile (<= 900px): full-screen modal card (no rounded corners), with a top bar containing title + close button and a scrollable content area.

Add CSS:
- `.help-modal` and `.help-modal-card` modeled after `.nostalgia-modal`.
- `.help-modal-content` as the scroll container.
- A small, accessible section picker UI (list or select) that remains usable on mobile.
  </action>
  <verify>pnpm -s run typecheck</verify>
  <done>HelpModal renders with a desktop overlay + mobile full-screen layout, and background scroll is locked while open.</done>
</task>

<task type="auto">
  <name>Task 3: Wire Help open button + persistence in App</name>
  <files>src/App.tsx</files>
  <action>
Wire Help into `src/App.tsx`:

- Add a single header help icon button rendered next to the tablist (within the existing header/nav area).
- Use `HelpIcon` from `src/ui/icons/coreIcons.tsx`.
- Add `aria-label="Open help"` and `data-testid="help-open"` to the button.
- Add localStorage persistence under key `emily-idle:help` storing `{ lastSectionId: string }`.
- On open: set active section to `lastSectionId` if present; otherwise default to the first section.
- When the user selects a section in HelpModal: update `lastSectionId` in state and persist to localStorage.
- Render `<HelpModal ... />` from App so it is available regardless of active tab.

Do NOT store Help state in the existing `Settings` type to avoid a multi-file settings type update (tabs duplicate Settings types).
  </action>
  <verify>pnpm -s run typecheck</verify>
  <done>
- Help button is present and opens the Help modal from any tab.
- Selecting a section, closing, and reopening shows the previously selected section.
  </done>
</task>

</tasks>

<verification>
- `pnpm -s run typecheck`
- `pnpm -s run test:unit`
</verification>

<success_criteria>
- `data-testid="help-open"` exists and opens `data-testid="help-modal"`.
- On small viewport widths (<= 900px), the modal is full-screen and scrollable.
- The last-open help section persists across close/reopen via localStorage.
</success_criteria>

<output>
After completion, create `.planning/phases/20-help-iconography/20-02-SUMMARY.md`
</output>
