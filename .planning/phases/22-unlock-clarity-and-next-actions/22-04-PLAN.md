---
phase: 22-unlock-clarity-and-next-actions
plan: 04
type: execute
wave: 3
depends_on:
  - 22-03
files_modified:
  - src/ui/tabs/CatalogTab.tsx
autonomous: true

must_haves:
  truths:
    - "Catalog empty states explain the panel purpose and offer one clear next action"
    - "Empty state CTA uses activateTab navigation (no router)"
  artifacts:
    - path: "src/ui/tabs/CatalogTab.tsx"
      provides: "Empty state blocks with CTA to Vault"
  key_links:
    - from: "src/ui/tabs/CatalogTab.tsx"
      to: "src/ui/components/EmptyStateCTA.tsx"
      via: "rendered when catalog lists are empty"
      pattern: "<EmptyStateCTA"
---

<objective>
Upgrade Catalog tab empty states to be explanatory and actionable, using the shared empty-state CTA component.

Purpose: Satisfy CLAR-02 (explain what the panel is for + one clear next action).
Output: Catalog empty states that point users back to Vault actions.
</objective>

<execution_context>
@~/.opencode/get-shit-done/workflows/execute-plan.md
@~/.opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@src/ui/tabs/CatalogTab.tsx
@src/ui/components/EmptyStateCTA.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add empty state CTA blocks for discovered + owned catalog lists</name>
  <files>src/ui/tabs/CatalogTab.tsx</files>
  <action>
Update `src/ui/tabs/CatalogTab.tsx`:

- Add a new prop `onNavigate: (tabId: TabId, scrollTargetId?: string) => void` (it is already plumbed from App in Plan 22-03).
- Import and use `EmptyStateCTA` in both existing empty paragraphs:
  1) Discovered catalog empty (currently `data-testid="catalog-discovered-empty"`):
     - Replace the plain paragraph with `EmptyStateCTA` while preserving `data-testid` stability (keep the existing test id either on the wrapper or via `testId` prop).
     - Copy:
       - title: "No references discovered yet"
       - body: "Buy and interact with watches in the Vault to discover catalog references and unlock tier bonuses."
       - CTA label: "Go to Vault"
       - CTA action: `onNavigate("collection", "collection-list")`

  2) Owned-view catalog empty (currently `data-testid="catalog-owned-empty"`):
     - Similar replacement.
     - Copy:
       - title: "No owned references yet"
       - body: "Build your vault collection to start filling your archive shelf with owned references."
       - CTA label: "Build collection"
       - CTA action: `onNavigate("collection", "collection-list")`

Keep the rest of the Catalog UI unchanged. Ensure there is exactly ONE CTA per empty state.
  </action>
  <verify>pnpm run typecheck</verify>
  <done>
Catalog empty states are explanatory and include a single CTA that navigates to Vault.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update/extend unit coverage for empty state CTA rendering</name>
  <files>tests/unlock-components.unit.test.tsx</files>
  <action>
Extend `tests/unlock-components.unit.test.tsx` (created in Plan 22-02) to render `CatalogTab` in an empty state and assert:
- The empty state block is rendered (via existing `data-testid` values).
- Clicking the CTA calls `onNavigate` with `("collection", "collection-list")`.

Use minimal props; pass empty arrays for catalog lists.
  </action>
  <verify>pnpm run test:unit tests/unlock-components.unit.test.tsx</verify>
  <done>
Unit tests confirm Catalog empty state CTAs call the correct navigation target.
  </done>
</task>

</tasks>

<verification>
- `pnpm run lint`
- `pnpm run test:unit`
</verification>

<success_criteria>
- Catalog tab never shows a dead-end: empty panels explain what to do next.
</success_criteria>

<output>
After completion, create `.planning/phases/22-unlock-clarity-and-next-actions/22-04-SUMMARY.md`
</output>
