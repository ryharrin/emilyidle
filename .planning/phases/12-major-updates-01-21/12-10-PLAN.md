---
phase: 12-major-updates-01-21
plan: 10
type: execute
---

<objective>
Configure GitHub Pages deployment for the Vite app.

Purpose: Publish the game to `/emilyidle/` for easy access and sharing.
Output: Vite base path update and GitHub Actions workflow for Pages deployment.
</objective>

<execution_context>
~/.config/opencode/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-major-updates-01-21/12-RESEARCH.md
@.planning/codebase/STRUCTURE.md
@NOTES.md
@.sisyphus/plans/notes-planned-features.md
@vite.config.ts
@package.json
@src/game/catalog.ts
@.github/workflows/pages.yml
</context>

<tasks>

<task type="auto">
  <name>Task 1: Verify Vite base path and BASE_URL-safe assets</name>
  <files>vite.config.ts, src/game/catalog.ts</files>
  <action>The repo is intended to deploy under `/emilyidle/`. First confirm `vite.config.ts` sets `base: "/emilyidle/"`.

Then audit any runtime asset URL concatenation to ensure it uses `import.meta.env.BASE_URL` (per Vite public base path guidance). `src/game/catalog.ts` should build local catalog URLs from `import.meta.env.BASE_URL`.

Avoid changing unrelated Vite options.

Reference: `.planning/phases/12-major-updates-01-21/12-RESEARCH.md` (Pitfall: base path drift).</action>
  <verify>pnpm run build</verify>
  <done>Build completes and generated asset paths include `/emilyidle/` (and dynamic catalog URLs are BASE_URL-safe).</done>
</task>

<task type="auto">
  <name>Task 2: Align GitHub Pages workflow with official actions</name>
  <files>.github/workflows/pages.yml</files>
  <action>A Pages workflow already exists in `.github/workflows/pages.yml`. Update it to follow the official GitHub Pages Actions flow and current action versions.

Requirements:
- Use `actions/configure-pages@v5`, `actions/upload-pages-artifact@v4`, and `actions/deploy-pages@v4`.
- Keep `permissions: contents: read, pages: write, id-token: write`.
- Ensure Playwright browsers install step exists before `pnpm run test:e2e`.
- Ensure `pnpm run test:unit`, `pnpm run test:e2e`, and `pnpm run build` run before uploading `dist`.

Reference:
- Vite GitHub Pages deploy guide: https://vite.dev/guide/static-deploy.html#github-pages
- GitHub Pages custom workflow docs: https://docs.github.com/en/pages/getting-started-with-github-pages/using-custom-workflows-with-github-pages</action>
  <verify>Workflow file present; uses configure-pages@v5, upload-pages-artifact@v4, deploy-pages@v4; `pnpm run test:unit`, `pnpm run test:e2e`, `pnpm run build` are in the build job</verify>
  <done>Workflow is aligned to official Pages actions and runs tests + build before deploying `dist/` on pushes to `main`.</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `pnpm run test:unit`
- [ ] `pnpm run test:e2e`
- [ ] `pnpm run build`
</verification>

<success_criteria>
- Vite uses `/emilyidle/` base path
- Pages workflow builds and deploys on push to `main`
  </success_criteria>

<output>
After completion, create `.planning/phases/12-major-updates-01-21/12-10-SUMMARY.md`:

# Phase 12 Plan 10 Summary

**Configured GitHub Pages deployment for the Vite app.**

## Accomplishments
- [ ] ...

## Files Created/Modified
- `vite.config.ts` - ...
- `.github/workflows/pages.yml` - ...

## Decisions Made
- None

## Issues Encountered
- None

## Next Step
- Phase complete, ready for next phase
</output>
