---
phase: 18-codebase-refactor
plan: 2
type: execute
wave: 2
depends_on: ["01"]
files_modified:
  - src/game/state.ts
  - src/game/data/items.ts
  - src/game/data/upgrades.ts
  - src/game/data/milestones.ts
  - src/game/data/setBonuses.ts
autonomous: true

must_haves:
  truths:
    - "Static game definitions live under src/game/data/* (not in src/game/state.ts)"
    - "Existing exports from src/game/state.ts still compile (no call-site churn in this step)"
    - "No numeric constants, ids, costs, or thresholds change during the move"
  artifacts:
    - path: "src/game/data/items.ts"
      provides: "Watch item definitions (data only)"
    - path: "src/game/data/upgrades.ts"
      provides: "Upgrade definitions (data only)"
    - path: "src/game/data/milestones.ts"
      provides: "Milestone definitions (data only)"
    - path: "src/game/data/setBonuses.ts"
      provides: "Set bonus definitions (data only)"
    - path: "src/game/state.ts"
      provides: "Facade module importing data modules to serve existing exports"
  key_links:
    - from: "src/game/state.ts"
      to: "src/game/data/items.ts"
      via: "import"
      pattern: "from\\s+\"\\./data/items\""
    - from: "src/game/state.ts"
      to: "src/game/data/upgrades.ts"
      via: "import"
      pattern: "from\\s+\"\\./data/upgrades\""
---

<objective>
Extract static game definition data out of `src/game/state.ts` into `src/game/data/*`, while keeping `src/game/state.ts` as the stable import surface.

Purpose: Reduce the size/surface of `src/game/state.ts` and establish a clean data layer for later selector/action extraction.
Output: `src/game/data/*` modules + `src/game/state.ts` updated to consume them.
</objective>

<execution_context>
@~/.opencode/get-shit-done/workflows/execute-plan.md
@~/.opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@.planning/phases/18-codebase-refactor/18-CONTEXT.md
@.planning/phases/18-codebase-refactor/18-RESEARCH.md

@src/game/state.ts
@src/game/model/types.ts
@src/game/model/state.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extract static definitions into src/game/data/*</name>
  <files>
src/game/state.ts
src/game/data/items.ts
src/game/data/upgrades.ts
src/game/data/milestones.ts
src/game/data/setBonuses.ts
  </files>
  <action>
- Create `src/game/data/items.ts`, `src/game/data/upgrades.ts`, `src/game/data/milestones.ts`, `src/game/data/setBonuses.ts`.
- Move static definition data (arrays/records/constants and their helper types) out of `src/game/state.ts` into these modules.
- Keep these data modules side-effect free and React-free.
- Update `src/game/state.ts` to import these definitions so existing exports keep working.
- Avoid behavior changes: do not change numeric constants, costs, thresholds, or ids.
  </action>
  <verify>pnpm run typecheck && pnpm run test:unit</verify>
  <done>
- Static definitions no longer live in `src/game/state.ts`.
- New `src/game/data/*` modules exist and are imported by `src/game/state.ts`.
- `pnpm run typecheck` succeeds.
- `pnpm run test:unit` succeeds (guards against accidental constant/id changes surfacing as behavior regressions).
  </done>
</task>

</tasks>

<verification>
- `pnpm run typecheck`
- `pnpm run test:unit`
</verification>

<success_criteria>
- Static definitions are separated into focused `src/game/data/*` modules.
- No gameplay behavior changes beyond incidental bug fixes discovered during refactor.
</success_criteria>

<output>
After completion, create `.planning/phases/18-codebase-refactor/18-02-SUMMARY.md`
</output>
