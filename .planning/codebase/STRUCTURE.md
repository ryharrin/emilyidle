# Codebase Structure

**Analysis Date:** 2026-01-21

## Directory Layout

```
watch-idle/
├── .github/                 # GitHub Actions workflows
│   └── workflows/pages.yml  # Pages deploy pipeline
├── .planning/               # Planning docs (generated)
├── public/                  # Static assets
│   ├── AGENTS.md            # Asset guidance
│   └── catalog/             # Watch catalog images
├── src/                     # Application source
│   ├── App.tsx              # Main UI + game loop
│   ├── main.tsx             # React entry point
│   ├── main.ts              # Empty stub
│   ├── style.css            # Global styling
│   ├── vite-env.d.ts        # Vite types
│   └── game/                # Game domain logic
│       ├── state.ts         # Game state + actions
│       ├── sim.ts           # Simulation tick loop
│       ├── persistence.ts   # Save encoding/decoding
│       ├── catalog.ts       # Catalog data + imagery metadata
│       ├── format.ts        # Formatting helpers
│       └── AGENTS.md        # Game logic notes
├── tests/                   # Unit + e2e tests
│   ├── *.unit.test.tsx      # Vitest unit tests
│   ├── *.spec.ts            # Playwright e2e tests
│   ├── vitest.setup.ts      # Test setup
│   └── AGENTS.md            # Testing notes
├── target/                  # Generated artifacts
├── test-results/            # Playwright output
├── index.html               # HTML entry document
├── package.json             # Project manifest
├── pnpm-lock.yaml           # pnpm lockfile
├── package-lock.json        # npm lockfile (legacy)
├── tsconfig.json            # TypeScript config
├── vite.config.ts           # Vite config
├── vitest.config.ts         # Vitest config
├── playwright.config.ts     # Playwright config
├── eslint.config.js         # ESLint config
├── .prettierrc.json         # Prettier config
└── watch-images.{csv,json}  # Unused data blobs
```

## Directory Purposes

**src/**
- Purpose: Core application code
- Contains: React UI and game logic
- Key files: `src/App.tsx`, `src/main.tsx`
- Subdirectories: `src/game/` (domain logic)

**src/game/**
- Purpose: Game rules, state, persistence, and catalog data
- Contains: `state.ts`, `sim.ts`, `persistence.ts`, `catalog.ts`, `format.ts`
- Key files: `src/game/state.ts` (GameState + actions)

**public/**
- Purpose: Static assets served by Vite
- Contains: `public/catalog/` watch images
- Key files: `public/AGENTS.md`

**tests/**
- Purpose: Unit and e2e tests
- Contains: `*.unit.test.tsx`, `*.spec.ts`
- Key files: `tests/catalog.unit.test.tsx`, `tests/collection-loop.spec.ts`

## Key File Locations

**Entry Points:**
- `index.html` - HTML entry document
- `src/main.tsx` - React root bootstrap

**Configuration:**
- `package.json` - Scripts and dependencies
- `tsconfig.json` - TypeScript compiler options
- `vite.config.ts` - Vite base path + plugins
- `vitest.config.ts` - Unit test configuration
- `playwright.config.ts` - E2E test configuration
- `eslint.config.js` - Linting rules
- `.prettierrc.json` - Formatting rules

**Core Logic:**
- `src/App.tsx` - UI + game loop orchestration
- `src/game/state.ts` - Game state and actions
- `src/game/sim.ts` - Simulation tick
- `src/game/persistence.ts` - Save/load
- `src/game/catalog.ts` - Catalog data and attribution

**Testing:**
- `tests/*.unit.test.tsx` - Unit tests (Vitest + Testing Library)
- `tests/*.spec.ts` - E2E tests (Playwright)

**Documentation:**
- `README.md` - Overview + commands
- `AGENTS.md` - Project notes

## Naming Conventions

**Files:**
- PascalCase for React component entry (`App.tsx`)
- lower-case module files for domain logic (`state.ts`, `sim.ts`)
- `*.unit.test.tsx` for unit tests, `*.spec.ts` for e2e tests

**Directories:**
- lower-case names (`src/`, `public/`, `tests/`, `game/`)

**Special Patterns:**
- `AGENTS.md` files document subsystem guidance
- `vite-env.d.ts` for Vite typings

## Where to Add New Code

**New Feature:**
- Primary code: `src/App.tsx` (current pattern)
- Tests: `tests/*.unit.test.tsx` or `tests/*.spec.ts`
- Config if needed: root configs (`vite.config.ts`, `tsconfig.json`)

**New Component/Module:**
- Implementation: `src/` (consider creating `src/components/` if extracting)
- Types: `src/game/state.ts` for shared domain types
- Tests: `tests/*.unit.test.tsx`

**New Route/Command:**
- Not applicable (no server/router layer detected)

**Utilities:**
- Shared helpers: `src/game/format.ts` or new module under `src/game/`
- Type definitions: `src/game/state.ts`

## Special Directories

**dist/**
- Purpose: Build output
- Source: Generated by `pnpm run build`
- Committed: No (gitignored)

**test-results/**
- Purpose: Playwright artifacts
- Source: Generated by `pnpm run test:e2e`
- Committed: No (generated output)

**target/**
- Purpose: Generated artifacts (unspecified)
- Source: Generated during local workflows
- Committed: No (generated output)

**.planning/**
- Purpose: Planning and codebase docs
- Source: Generated by mapping workflow
- Committed: Yes

---

*Structure analysis: 2026-01-21*
*Update when directory structure changes*
